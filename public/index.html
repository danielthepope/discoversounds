<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Discover Sounds</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Permanent+Marker" rel="stylesheet">
    <!-- F**k yeah, Bootstrap. -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css" integrity="sha384-PmY9l28YgO4JwMKbTvgaS7XNZJ30MK9FAZjjzXtlqyZCqBY6X6bXIkM++IkyinN+" crossorigin="anonymous">
    <!-- F**k yeah, jQuery. -->
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <link rel="stylesheet" href="css/site.css">
    <link rel="stylesheet" href="css/selectize.bootstrap3.css">
    <script src="js/selectize.min.js"></script>
</head>
<body>
    <div class="container">
        <h1><img class="icon" src="header-icon-small.png" alt=""> Discover Sounds</h1>
        <p class="lead">Find shows on BBC Sounds you never knew existed.</p>
        <form action="search" method="GET">
            <select name="artist" id="multi-input" placeholder="Type artist names here" multiple="multiple" class="form-control"></select>

            <p>Return:</p>
            <div class="checkbox">
                <label for="radio_html">
                    <input type="radio" class="form-check-input" name="redirect" value="html" id="radio_html" checked>
                    Up to 10 results
                </label>
            </div>
            <div class="checkbox">
                <label for="radio_none">
                    <input type="radio" class="form-check-input" name="redirect" value="none" id="radio_none">
                    Up to 10 results (JSON)
                </label>
            </div>
            <div class="checkbox">
                <label for="radio_programmes">
                    <input type="radio" class="form-check-input" name="redirect" value="programmes" id="radio_programmes">
                    I'm feeling lucky<br>
                    <small>If there are multiple matches, this will take you to a random match on bbc.co.uk/programmes</small>
                </label>
            </div>
            <input class="btn btn-primary" type="submit" value="Go!">
        </form>
        <hr>
        <h2>What is this?</h2>
        <p>I indexed the artists played on all BBC radio stations from mid-January to mid-February.</p>
        <p>Choose your favourite artists and this service will find a radio show that plays most of them. The more artists you provide, the better the results will be.</p>
        <p>For example, if you submit The Strokes, Muse, Queens of the Stone Age and The White Stripes, you'll get <a href="https://www.bbc.co.uk/programmes/m00021nz">this episode</a> of Radio 1's Indie Show back.</p>
        <p>An <a href="https://github.com/danielthepope/discoversounds">open source project</a> created by <a href="https://twitter.com/danielthepope">Dan Pope</a> as part of a BBC hack day.</p>
    </div>
    <script>
        $('#multi-input').selectize({
            valueField: 'name',
            labelField: 'name',
            searchField: ['name'],
            create: false,
            persist: false,
            closeAfterSelect: true,
            load: function(query, callback) {
                if (!query.length) return callback();
                $.ajax({
                    url: '/artists?term=' + encodeURIComponent(query),
                    type: 'GET',
                    error: function() {
                        console.log('error')
                        callback();
                    },
                    success: function(res) {
                        console.log(res);
                        callback(res.map(function(a) {return {name: a}}));
                    }
                })
            }
        });
    </script>
</body>
</html>